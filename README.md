# YOLO11x Stream Detection

?? Ultralytics YOLO11x ??????????????? AI ??????? RTMP/HLS ??????????

## ? ????

### ???????

- **???? (Detect)** - ??????????
- **?????? (Pose)** - ??????????
- **???? (Segment)** - ???????
- **???? (Classify)** - ??????
- **????? (OBB)** - ??????
- **???? (Count)** - ??????
- **??? (Heatmap)** - ?????????
- **???? (Speed)** - ????????
- **???? (Workout)** - AI ??????
- **???? (TrackZone)** - ????????
- **???? (Blur)** - ????????

### ????

- ? ????? YOLO11x ????
- ? NVIDIA GPU ????
- ? RTMP ????
- ? HLS ?????
- ? Docker ?????
- ? ??????
- ? ???????

## ?? ????

### ????

- Docker 20.10+ ? Docker Compose 2.0+
- NVIDIA GPU????? NVIDIA Container Toolkit
- ?? RTMP ??????Mac/Windows/Linux + FFmpeg?

### ????

1. **????**

```bash
git clone <your-repo-url> yolo11x-stream-detection
cd yolo11x-stream-detection
```

2. **??????**

```bash
cp .env.example .env
# ?? .env ???????????
```

3. **????**

```bash
bash start.sh
```

4. **??**

???????Mac ????

```bash
ffmpeg -f avfoundation -framerate 30 -pixel_format nv12 \
  -video_size 1280x720 -i "0:" \
  -c:v libx264 -preset veryfast -tune zerolatency -pix_fmt yuv420p \
  -g 60 -b:v 3M -maxrate 3M -bufsize 6M \
  -f flv "rtmp://<your-server-ip>:1935/live/cam"
```

5. **?????**

```bash
# ?????
ffplay "http://<your-server-ip>:8080/detected/cam/index.m3u8"

# ?????
ffplay "http://<your-server-ip>:8080/pose/cam/index.m3u8"
```

## ?? ????

???????????????? [docs/README.md](docs/README.md)?

## ??? ????

```
???? (FFmpeg)
    ? RTMP
RTMP ??? (nginx-rtmp)
    ? ??
???? (YOLO11x)
    ? RTMP
RTMP ??? (??????)
    ? HLS
HLS ?????
```

## ?? ????

```
yolo11x-stream-detection/
??? docker-compose.yml       # Docker Compose ??
??? start.sh                 # ????
??? stop.sh                  # ????
??? restart.sh               # ????
??? status.sh                # ??????
??? .env.example             # ??????
??? .gitignore               # Git ????
??? config/
?   ??? rtmp-entrypoint.sh   # RTMP ?????
??? scripts/
?   ??? yolo_stream_detector.py    # ????
?   ??? yolo_pose_detector.py      # ????
?   ??? yolo_segment_detector.py   # ????
?   ??? ... (??????)
??? examples/
?   ??? push_stream_example.sh     # ??????
??? docs/
    ??? README.md            # ????
```

## ?? ????

### ??????

1. **????**

```bash
bash start.sh
```

2. **???Mac?**

```bash
# ??????
bash examples/push_stream_example.sh mac

# ?????
ffmpeg ... "rtmp://localhost:1935/live/cam"
```

3. **?????**

```bash
# ????
ffplay "http://localhost:8080/detected/cam/index.m3u8"

# ????
ffplay "http://localhost:8080/pose/cam/index.m3u8"
```

### ?????

?????????

```bash
# ??
STREAM_NAME=user1 bash examples/push_stream_example.sh mac

# ?????????? STREAM_NAME ?????
STREAM_NAME=user1 docker-compose restart yolo-detect
ffplay "http://localhost:8080/detected/user1/index.m3u8"
```

## ?? ????

### ????

`.env` ???????

- `RTMP_PUSH_KEY`: RTMP ?????????????????
- `STREAM_NAME`: ????????? `cam`?

### ????

- **1935**: RTMP ????
- **8080**: HLS HTTP ????
- **8081**: RTMP ????????????

## ?? ????

```bash
# ????
bash status.sh

# ????
bash restart.sh

# ????
bash stop.sh

# ????
docker-compose logs -f

# ????????
docker logs -f yolo-detect
```

## ?? ?? URL

???????????

```
http://<server-ip>:8080/<detection-type>/<stream-name>/index.m3u8
```

### ?? URL ??

| ???? | URL ?? |
|---------|---------|
| ??? | `/live/{stream_name}/index.m3u8` |
| ???? | `/detected/{stream_name}/index.m3u8` |
| ???? | `/pose/{stream_name}/index.m3u8` |
| ???? | `/segment/{stream_name}/index.m3u8` |
| ???? | `/classify/{stream_name}/index.m3u8` |
| ????? | `/obb/{stream_name}/index.m3u8` |
| ???? | `/count/{stream_name}/index.m3u8` |
| ??? | `/heatmap/{stream_name}/index.m3u8` |
| ???? | `/speed/{stream_name}/index.m3u8` |
| ???? | `/workout/{stream_name}/index.m3u8` |
| ???? | `/trackzone/{stream_name}/index.m3u8` |
| ???? | `/blur/{stream_name}/index.m3u8` |

## ?? ????

### ????

- ?? RTMP ????????`docker ps | grep rtmp`
- ?????????`netstat -tlnp | grep 1935`
- ?? RTMP ???`docker logs rtmp`

### HLS ?? 404

- ????????
- ????? HLS ????
- ?? HLS ???`docker exec rtmp ls -lh /opt/data/hls/cam/`

### ????????

- ???????`docker logs yolo-detect`
- ?? RTMP ???????`curl http://localhost:8080/stat`
- ????????`docker exec yolo-detect printenv STREAM_NAME`

??????????? [docs/TROUBLESHOOTING.md](docs/TROUBLESHOOTING.md)?

## ?? ????

- [Ultralytics YOLO ??](https://docs.ultralytics.com/)
- [Nginx RTMP ??](https://github.com/arut/nginx-rtmp-module)
- [FFmpeg ??](https://ffmpeg.org/documentation.html)

## ?? ???

????? Ultralytics YOLO?????????????

## ?? ??

???? Issue ? Pull Request?

---

**??**: 1.0  
**????**: 2025-11-01
