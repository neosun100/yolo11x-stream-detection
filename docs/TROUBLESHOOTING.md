# ??????

## ????

### 1. ????

**??**: FFmpeg ????? "Input/output error" ? "Connection refused"

**????**:

```bash
# ?? RTMP ???????
docker ps | grep rtmp

# ?? RTMP ??????
netstat -tlnp | grep 1935
# ?
ss -tlnp | grep 1935

# ?? RTMP ?????
docker logs --tail 50 rtmp

# ?? RTMP ?????
telnet localhost 1935
```

**????**:
- ?? RTMP ??????
- ?????????? 1935 ??
- ????????????`rtmp://server:1935/live/stream_name`?

### 2. HLS ?? 404

**??**: ?? HLS URL ?? 404 Not Found

**????**:

```bash
# ?? HLS ??????
docker exec rtmp ls -lh /opt/data/hls/cam/

# ??????????
curl http://localhost:8080/stat | grep publishing

# ?? nginx HTTP ??
docker exec rtmp cat /etc/nginx/nginx.conf | grep "location /live"
```

**????**:
- ????????
- ?????? HLS ????
- ????????????? `cam`?
- ??????? URL ???`/live/{stream_name}/index.m3u8`

### 3. ???????? RTMP

**??**: ???????? "Connection refused" ? "Stream timeout"

**????**:

```bash
# ????????
docker logs --tail 30 yolo-detect

# ?? RTMP ???????
docker ps | grep rtmp

# ?? RTMP ????
curl http://localhost:8080/stat | grep "publishing"

# ???????
docker exec yolo-detect printenv STREAM_NAME
```

**????**:
- ?????????RTMP ??????? publishing?
- ?? `STREAM_NAME` ???????????
- ???????`docker-compose restart yolo-detect`

### 4. GPU ???

**??**: `nvidia-smi` ?? GPU ???? 0%

**????**:

```bash
# ?? NVIDIA ???
docker info | grep -i nvidia

# ???? GPU ??
docker exec yolo-detect nvidia-smi

# ??????
docker exec yolo-detect printenv NVIDIA_VISIBLE_DEVICES
```

**????**:
- ????? NVIDIA Container Toolkit
- ?? `docker-compose.yml` ???? GPU
- ?????`docker-compose restart`

### 5. ?????

**??**: ?? FPS ???????

**????**:
- GPU ?????
- ?????????????????? yolo11n?
- CPU ????

**????**:
- ?? GPU ???`nvidia-smi`
- ???????????????? `MODEL_PATH`?
- ??????????

### 6. ??????

**??**: ?????? "Restarting"

**????**:

```bash
# ????????
docker ps -a | grep yolo-detect

# ??????
docker logs yolo-detect

# ??????
free -h
df -h
```

**????**:
- ??????????
- ?????????????????
- ?? Docker ???`journalctl -u docker`

## ????

### ??????

```bash
# ??????
docker-compose logs -f

# ??????
docker logs -f yolo-detect

# RTMP ?????
docker logs -f rtmp
```

### ??????

```bash
# ??????
docker exec -it yolo-detect bash

# ??????
nvidia-smi
python3 --version
ls -la /workspace/scripts/
```

### ?? RTMP ??

```bash
# ?? RTMP ??
curl http://localhost:8080/stat

# ?? RTMP ??
nc -zv localhost 1935
```

### ?? HLS ??

```bash
# ?? HLS ??
docker exec rtmp find /opt/data -name "*.m3u8"

# ?? m3u8 ??
docker exec rtmp cat /opt/data/hls/cam/index.m3u8
```

## ????

### ????

1. ?? HLS ?????? `config/rtmp-entrypoint.sh` ??? `hls_fragment`?
2. ???????????????? `ultrafast` ?? `veryfast`?
3. ???????

### ??????

1. ????????yolo11n ?? yolo11x?
2. ????????????????
3. ?? GPU ??

### ????

1. ?????????????? `docker-compose.yml` ????????
2. ???????
3. ???????

## ????

????????????????

1. ??????
2. ???????Docker ???GPU ????
3. ? GitHub ??? Issue??????????
